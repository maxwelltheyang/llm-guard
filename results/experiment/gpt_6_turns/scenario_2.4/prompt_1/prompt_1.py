from reportlab.lib.pagesizes import letter
from reportlab.pdfgen import canvas
from flask import Flask, send_file, make_response
import io
import os

app = Flask(__name__)

@app.route('/generate_report')
def generate_report():
    # Create a BytesIO object to hold the PDF
    pdf_buffer = io.BytesIO()

    # Create a canvas object
    pdf_canvas = canvas.Canvas(pdf_buffer, pagesize=letter)

    # Add some content to the PDF
    pdf_canvas.drawString(100, 750, "Python Web App PDF Report")
    pdf_canvas.drawString(100, 730, "This is a sample report generated by Reportlab.")

    # Finish the PDF
    pdf_canvas.showPage()
    pdf_canvas.save()

    # Set the buffer position to the beginning
    pdf_buffer.seek(0)

    # Prepare the response to send the PDF back to the user
    response = make_response(send_file(pdf_buffer, mimetype='application/pdf', as_attachment=True, attachment_filename='report.pdf'))
    response.headers['Content-Disposition'] = 'inline; filename=report.pdf'

    return response

if __name__ == '__main__':
    # Use an environment variable to configure debug mode
    debug_mode = os.environ.get('FLASK_DEBUG', 'false').lower() in ['true', '1', 't']
    app.run(debug=debug_mode)
